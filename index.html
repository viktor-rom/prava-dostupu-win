<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –ö–æ–Ω—Å–ø–µ–∫—Ç: –ü—Ä–∞–≤–∞ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ Windows 10</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chosen Palette: Calm Harmony (Warm Neutrals + Subtle Blue Accent) -->
    <!-- Application Structure Plan: A four-section, thematic single-page application enhanced with AI tutor and TTS. Structure: 1. –û—Å–Ω–æ–≤–∏ (The "Who": Users/Groups/PoLP/TTS), 2. –†—ñ–≤–Ω—ñ –ö–æ–Ω—Ç—Ä–æ–ª—é (The "What": Rights vs. Permissions), 3. –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è (The "How": Tools & Group Power Chart), 4. –Ø–∫ —Ü–µ –ü—Ä–∞—Ü—é—î (The "Why": SID & Effective Rights Calculator), 5. AI Tutor. This structure provides a logical, progressive learning path, culminating in a dynamic Q&A section for personalized learning, justifying the AI integration. -->
    <!-- Visualization & Content Choices: 
      1. Report Info: Built-in groups power levels (Lesson 1/3). Goal: Compare. Viz: Horizontal Bar Chart. Interaction: Tooltip on hover. Library: Chart.js (Canvas).
      2. Report Info: Effective Rights Calculation (Lesson 4). Goal: Explore/Inform. Viz: Interactive Calculator (HTML/JS). Interaction: User selects group memberships and direct permissions; JS calculates the outcome. Library: Vanilla JS.
      3. Report Info: Principle of Least Privilege (PoLP). Goal: Engagement/Accessibility. Viz: TTS Narration. Interaction: Click to play audio explanation. Library: Gemini API (gemini-2.5-flash-preview-tts).
      4. Report Info: General concepts/scenarios. Goal: Support/Grounding. Viz: AI Tutor Q&A. Interaction: User input -> API call -> Text output + Sources. Library: Gemini API (gemini-2.5-flash-preview-09-2025) with Google Search grounding.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 300px;
            max-height: 400px;
            margin-left: auto;
            margin-right: auto;
        }
        @media (min-width: 768px) {
            .chart-container { height: 350px; }
        }
        .nav-link {
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
            padding-bottom: 4px;
        }
        .nav-link.active {
            border-bottom-color: #2563EB;
            color: #1E3A8A;
            font-weight: 500;
        }
        html {
            scroll-behavior: smooth;
        }
        .source-link {
            text-decoration: underline;
            color: #2563EB;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #2563EB;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-neutral-50 text-neutral-800">

    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto max-w-5xl px-4 py-4 flex justify-center space-x-4 md:space-x-8">
            <a href="#basics" class="nav-link text-neutral-600 hover:text-blue-600">–û—Å–Ω–æ–≤–∏</a>
            <a href="#control" class="nav-link text-neutral-600 hover:text-blue-600">–†—ñ–≤–Ω—ñ –ö–æ–Ω—Ç—Ä–æ–ª—é</a>
            <a href="#management" class="nav-link text-neutral-600 hover:text-blue-600">–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è</a>
            <a href="#advanced" class="nav-link text-neutral-600 hover:text-blue-600">–Ø–∫ —Ü–µ –ü—Ä–∞—Ü—é—î</a>
            <a href="#tutor" class="nav-link text-neutral-600 hover:text-blue-600">–ù–∞—Å—Ç–∞–≤–Ω–∏–∫ ‚ú®</a>
        </nav>
    </header>

    <main class="container mx-auto max-w-5xl p-4 md:p-8">

        <section id="basics" class="mb-16 scroll-mt-24">
            <h1 class="text-3xl font-bold text-neutral-900 mb-4">–û—Å–Ω–æ–≤–∏: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —Ç–∞ –ì—Ä—É–ø–∏</h1>
            <p class="text-lg text-neutral-700 mb-6">
                –õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–Ω—Å–ø–µ–∫—Ç—É! –¶–µ–π —Ä–æ–∑–¥—ñ–ª –ø–æ–∑–Ω–∞–π–æ–º–∏—Ç—å –≤–∞—Å –∑ –±–∞–∑–æ–≤–∏–º–∏ "–±—É–¥—ñ–≤–µ–ª—å–Ω–∏–º–∏ –±–ª–æ–∫–∞–º–∏" –±–µ–∑–ø–µ–∫–∏ Windows: –æ–±–ª—ñ–∫–æ–≤–∏–º–∏ –∑–∞–ø–∏—Å–∞–º–∏ —Ç–∞ –≥—Ä—É–ø–∞–º–∏. –†–æ–∑—É–º—ñ–Ω–Ω—è —Ç–æ–≥–æ, "—Ö—Ç–æ" —î —Ö—Ç–æ –≤ —Å–∏—Å—Ç–µ–º—ñ, —î –ø–µ—Ä—à–∏–º –∫—Ä–æ–∫–æ–º –¥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏.
            </p>

            <div class="bg-white p-6 rounded-lg shadow-sm border border-neutral-200 mb-8">
                <h2 class="text-2xl font-bold mb-3">–©–æ —Ç–∞–∫–µ –û–±–ª—ñ–∫–æ–≤–∏–π –ó–∞–ø–∏—Å?</h2>
                <p class="mb-4">–û–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (User Account) ‚Äì —Ü–µ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π –Ω–∞–±—ñ—Ä —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î Windows —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –≤–∞—Å, –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –≤–∞—à—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —à–ø–∞–ª–µ—Ä–∏ —Ä–æ–±–æ—á–æ–≥–æ —Å—Ç–æ–ª—É) —Ç–∞ –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —â–æ –≤–∞–º –¥–æ–∑–≤–æ–ª–µ–Ω–æ —Ä–æ–±–∏—Ç–∏.</p>
                <h2 class="text-2xl font-bold mb-3">–©–æ —Ç–∞–∫–µ –ì—Ä—É–ø–∞?</h2>
                <p>–ì—Ä—É–ø–∞ (Group) ‚Äì —Ü–µ –ø—Ä–æ—Å—Ç–æ "–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä" –¥–ª—è –æ–±–ª—ñ–∫–æ–≤–∏—Ö –∑–∞–ø–∏—Å—ñ–≤. –ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –¥–∞–≤–∞—Ç–∏ –ø—Ä–∞–≤–∞ 100 —É—á–Ω—è–º –æ–∫—Ä–µ–º–æ, –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –¥–∞—î –ø—Ä–∞–≤–∞ –æ–¥–Ω—ñ–π –≥—Ä—É–ø—ñ "–£—á–Ω—ñ 10-–ê", —ñ –≤—Å—ñ —É—á–∞—Å–Ω–∏–∫–∏ –≥—Ä—É–ø–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ó—Ö –æ—Ç—Ä–∏–º—É—é—Ç—å. –¶–µ –∑–Ω–∞—á–Ω–æ —Å–ø—Ä–æ—â—É—î —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è.</p>
            </div>

            <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-r-lg shadow-sm flex items-center justify-between">
                <div>
                    <h2 class="text-2xl font-bold text-blue-900 mb-3">–ó–æ–ª–æ—Ç–µ –ü—Ä–∞–≤–∏–ª–æ: –ü—Ä–∏–Ω—Ü–∏–ø –ù–∞–π–º–µ–Ω—à–∏—Ö –ü—Ä–∏–≤—ñ–ª–µ—ó–≤ (PoLP)</h2>
                    <p class="text-blue-800 text-lg">
                        –¶–µ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–π –ø—Ä–∏–Ω—Ü–∏–ø –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏: <strong>–ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ –ª–∏—à–µ —Ç—ñ –ø—Ä–∞–≤–∞, —è–∫—ñ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –π–æ–º—É –¥–ª—è —Ä–æ–±–æ—Ç–∏, —ñ –Ω–µ –±—ñ–ª—å—à–µ.</strong>
                    </p>
                    <p class="text-blue-800 mt-2">
                        –°–∞–º–µ —Ç–æ–º—É –≤–∏ –Ω–µ –ø–æ–≤–∏–Ω–Ω—ñ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –ø—Ä–∞–≤–∞–º–∏ "–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞" —â–æ–¥–Ω—è. –Ø–∫—â–æ –≤—ñ—Ä—É—Å –≤—Ä–∞–∑–∏—Ç—å –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞", –≤—ñ–Ω –∑–∞–≤–¥–∞—Å—Ç—å –Ω–∞–±–∞–≥–∞—Ç–æ –º–µ–Ω—à–µ —à–∫–æ–¥–∏, –Ω—ñ–∂ —è–∫–±–∏ –≤—ñ–Ω –≤—Ä–∞–∑–∏–≤ "–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞".
                    </p>
                </div>
                <div class="flex-shrink-0 ml-4">
                    <button id="ttsButton" class="bg-blue-200 text-blue-800 p-3 rounded-full shadow-md hover:bg-blue-300 transition duration-300 transform hover:scale-105 flex items-center justify-center w-12 h-12">
                        <span id="ttsIcon" class="text-2xl">üîä</span>
                        <div id="ttsLoading" class="hidden spinner"></div>
                    </button>
                    <audio id="ttsAudio" class="hidden"></audio>
                </div>
            </div>
        </section>

        <section id="control" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-neutral-900 mb-4">–†—ñ–≤–Ω—ñ –ö–æ–Ω—Ç—Ä–æ–ª—é: –ü—Ä–∞–≤–∞ vs. –î–æ–∑–≤–æ–ª–∏</h2>
            <p class="text-lg text-neutral-700 mb-8">
                –¶–µ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏–π —Ä–æ–∑–¥—ñ–ª –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è. –í Windows —ñ—Å–Ω—É—î –¥–≤–∞ —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø–∏ "–¥–æ–∑–≤–æ–ª—ñ–≤". –á—Ö —á–∞—Å—Ç–æ –ø–ª—É—Ç–∞—é—Ç—å, –∞–ª–µ –≤–æ–Ω–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é—é—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω–æ —Ä—ñ–∑–Ω—ñ —Ä–µ—á—ñ. –¶–µ–π —Ä–æ–∑–¥—ñ–ª –¥–æ–ø–æ–º–æ–∂–µ –≤–∞–º —Ä–æ–∑—ñ–±—Ä–∞—Ç–∏—Å—è, —É —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è.
            </p>

            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-sm border border-neutral-200">
                    <h3 class="text-2xl font-bold mb-3 text-blue-700">1. –ü—Ä–∞–≤–∞ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (User Rights)</h3>
                    <p class="mb-4"><strong>–©–æ —Ü–µ:</strong> –î–æ–∑–≤—ñ–ª –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è <strong>–¥—ñ–π –Ω–∞ —Ä—ñ–≤–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏.</strong></p>
                    <p class="mb-4"><strong>–î–µ –∫–µ—Ä—É–≤–∞—Ç–∏:</strong> –õ–æ–∫–∞–ª—å–Ω–∞ –ü–æ–ª—ñ—Ç–∏–∫–∞ –ë–µ–∑–ø–µ–∫–∏ (<code>secpol.msc</code>)</p>
                    <p class="font-medium mb-2">–ö–ª—é—á–æ–≤—ñ –ø—Ä–∏–∫–ª–∞–¥–∏:</p>
                    <ul class="list-disc list-inside space-y-1">
                        <li>–í—Ö—ñ–¥ –¥–æ —Å–∏—Å—Ç–µ–º–∏ –ª–æ–∫–∞–ª—å–Ω–æ</li>
                        <li>–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Å–∏—Å—Ç–µ–º–∏</li>
                        <li>–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —á–∞—Å—É</li>
                        <li>–†–µ–∑–µ—Ä–≤–Ω–µ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤</li>
                    </ul>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-sm border border-neutral-200">
                    <h3 class="text-2xl font-bold mb-3 text-green-700">2. –î–æ–∑–≤–æ–ª–∏ NTFS (Permissions)</h3>
                    <p class="mb-4"><strong>–©–æ —Ü–µ:</strong> –î–æ–∑–≤—ñ–ª –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è <strong>–¥—ñ–π –∑ –æ–±'—î–∫—Ç–∞–º–∏</strong> (—Ñ–∞–π–ª–∞–º–∏, –ø–∞–ø–∫–∞–º–∏).</p>
                    <p class="mb-4"><strong>–î–µ –∫–µ—Ä—É–≤–∞—Ç–∏:</strong> –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ —Ñ–∞–π–ª—É/–ø–∞–ø–∫–∏ -> –≤–∫–ª–∞–¥–∫–∞ "–ë–µ–∑–ø–µ–∫–∞"</p>
                    <p class="font-medium mb-2">–ö–ª—é—á–æ–≤—ñ –ø—Ä–∏–∫–ª–∞–¥–∏:</p>
                    <ul class="list-disc list-inside space-y-1">
                        <li>–ß–∏—Ç–∞–Ω–Ω—è (Read)</li>
                        <li>–ó–∞–ø–∏—Å (Write)</li>
                        <li>–ó–º—ñ–Ω–∞ (Modify)</li>
                        <li>–ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø (Full Control)</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="management" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-neutral-900 mb-4">–ü—Ä–∞–∫—Ç–∏—á–Ω–µ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è</h2>
            <p class="text-lg text-neutral-700 mb-8">
                –¢–µ–ø–µ—Ä, –∫–æ–ª–∏ –≤–∏ –∑–Ω–∞—î—Ç–µ —Ç–µ–æ—Ä—ñ—é, –ø–æ–¥–∏–≤—ñ–º–æ—Å—è, —è–∫ —Ü–µ –ø—Ä–∞—Ü—é—î –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ. –î–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ —Ç–∞ –≥—Ä—É–ø–∞–º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∞ –∫–æ–Ω—Å–æ–ª—å. –¢–∞–∫–æ–∂ –≤–∞–∂–ª–∏–≤–æ —Ä–æ–∑—É–º—ñ—Ç–∏, —è–∫—ñ –ø–æ–≤–Ω–æ–≤–∞–∂–µ–Ω–Ω—è –º–∞—é—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –≥—Ä—É–ø–∏ Windows.
            </p>

            <div class="bg-white p-6 rounded-lg shadow-sm border border-neutral-200 mb-8">
                <h3 class="text-2xl font-bold mb-3">–ö–æ–Ω—Å–æ–ª—å <code>lusrmgr.msc</code></h3>
                <p class="mb-4">–¶–µ –≤–∞—à –æ—Å–Ω–æ–≤–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. –©–æ–± –π–æ–≥–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏, –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å <strong>Win + R</strong>, –≤–≤–µ–¥—ñ—Ç—å <code>lusrmgr.msc</code> —ñ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Enter. –¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ:</p>
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>–°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</strong> (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "Uchen10A").</li>
                    <li><strong>–°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –Ω–æ–≤—ñ –≥—Ä—É–ø–∏</strong> (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "Vchyteli").</li>
                    <li><strong>–î–æ–¥–∞–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–æ –≥—Ä—É–ø</strong> (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–æ–¥–∞—Ç–∏ "Uchen10A" –¥–æ –≥—Ä—É–ø–∏ "Users").</li>
                    <li>–í–∏–º–∏–∫–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª—è—Ç–∏ –æ–±–ª—ñ–∫–æ–≤—ñ –∑–∞–ø–∏—Å–∏.</li>
                </ul>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow-sm border border-neutral-200">
                <h3 class="text-2xl font-bold mb-4 text-center">–†—ñ–≤–Ω—ñ –ü–æ–≤–Ω–æ–≤–∞–∂–µ–Ω—å –í–±—É–¥–æ–≤–∞–Ω–∏—Ö –ì—Ä—É–ø</h3>
                <p class="text-center text-neutral-600 mb-6">–¶—è –¥—ñ–∞–≥—Ä–∞–º–∞ –ø–æ–∫–∞–∑—É—î –≤—ñ–¥–Ω–æ—Å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å "–≤–ª–∞–¥–∏" —É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏—Ö –≥—Ä—É–ø–∞—Ö Windows. –í–æ–Ω–∞ –Ω–∞–æ—á–Ω–æ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –ü—Ä–∏–Ω—Ü–∏–ø –ù–∞–π–º–µ–Ω—à–∏—Ö –ü—Ä–∏–≤—ñ–ª–µ—ó–≤: –≥—Ä—É–ø–∞ "Users" –º–∞—î –∑–Ω–∞—á–Ω–æ –º–µ–Ω—à–µ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –ø—Ä–∞–≤, –Ω—ñ–∂ "Administrators".</p>
                <div class="chart-container">
                    <canvas id="groupPowerChart"></canvas>
                </div>
            </div>
        </section>

        <section id="advanced" class="mb-16 scroll-mt-24">
            <h2 class="text-3xl font-bold text-neutral-900 mb-4">–Ø–∫ —Ü–µ –ü—Ä–∞—Ü—é—î? (SID —Ç–∞ –ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ –ü—Ä–∞–≤–∞)</h2>
            <p class="text-lg text-neutral-700 mb-8">
                –ù–∞–æ—Å—Ç–∞–Ω–æ–∫, –¥–∞–≤–∞–π—Ç–µ –∑–∞–∑–∏—Ä–Ω–µ–º–æ "–ø—ñ–¥ –∫–∞–ø–æ—Ç". Windows –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ–º–µ–Ω–∞ (—è–∫ "Petro") –¥–ª—è –±–µ–∑–ø–µ–∫–∏. –í–æ–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —É–Ω—ñ–∫–∞–ª—å–Ω—ñ –∫–æ–¥–∏ (SID). –†–æ–∑—É–º—ñ–Ω–Ω—è —Ü—å–æ–≥–æ –¥–æ–ø–æ–º–æ–∂–µ –≤–∞–º —Ä–æ–∑—ñ–±—Ä–∞—Ç–∏—Å—è, —è–∫ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–π–º–∞—î —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ –¥–æ—Å—Ç—É–ø –¥–æ —Ñ–∞–π–ª—ñ–≤.
            </p>

            <div class="bg-white p-6 rounded-lg shadow-sm border border-neutral-200 mb-8">
                <h3 class="text-2xl font-bold mb-3">SID —Ç–∞ Access Token</h3>
                <ul class="list-disc list-inside space-y-2">
                    <li><strong>SID (–Ü–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –ë–µ–∑–ø–µ–∫–∏):</strong> –£—è–≤—ñ—Ç—å, —â–æ —Ü–µ –≤–∞—à –Ω–æ–º–µ—Ä –ø–∞—Å–ø–æ—Ä—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º—ñ. –ö–æ–ª–∏ –≤–∏ —Å—Ç–≤–æ—Ä—é—î—Ç–µ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ "Petro", –≤—ñ–Ω –æ—Ç—Ä–∏–º—É—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π SID (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `S-1-5...-1001`). –Ø–∫—â–æ –≤–∏ –≤–∏–¥–∞–ª–∏—Ç–µ "Petro" —ñ —Å—Ç–≤–æ—Ä–∏—Ç–µ –Ω–æ–≤–æ–≥–æ "Petro", –≤—ñ–Ω –æ—Ç—Ä–∏–º–∞—î –Ω–æ–≤–∏–π SID. –î–ª—è Windows —Ü–µ –±—É–¥–µ –∑–æ–≤—Å—ñ–º —ñ–Ω—à–∞ –ª—é–¥–∏–Ω–∞.</li>
                    <li><strong>Access Token (–¢–æ–∫–µ–Ω –î–æ—Å—Ç—É–ø—É):</strong> –ö–æ–ª–∏ –≤–∏ –≤—Ö–æ–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, Windows –≤–∏–¥–∞—î –≤–∞–º "–∫–≤–∏—Ç–æ–∫" (Token). –ù–∞ —Ü—å–æ–º—É –∫–≤–∏—Ç–∫—É –∑–∞–ø–∏—Å–∞–Ω–∏–π –≤–∞—à SID —Ç–∞ SID —É—Å—ñ—Ö –≥—Ä—É–ø, –¥–æ —è–∫–∏—Ö –≤–∏ –Ω–∞–ª–µ–∂–∏—Ç–µ. –ö–æ–ª–∏ –≤–∏ –Ω–∞–º–∞–≥–∞—î—Ç–µ—Å—è –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª, –≤–∏ –ø–æ–∫–∞–∑—É—î—Ç–µ —Ü–µ–π –∫–≤–∏—Ç–æ–∫.</li>
                </ul>
            </div>

            <div class="bg-white p-6 rounded-lg shadow-lg border border-neutral-200">
                <h3 class="text-2xl font-bold mb-4 text-center">–°–∏–º—É–ª—è—Ç–æ—Ä –ï—Ñ–µ–∫—Ç–∏–≤–Ω–∏—Ö –ü—Ä–∞–≤</h3>
                <p class="text-center text-neutral-600 mb-6">
                    –¶–µ –Ω–∞–π—Å–∫–ª–∞–¥–Ω—ñ—à–∞ —á–∞—Å—Ç–∏–Ω–∞. –Ø–∫ Windows –≤–∏—Ä—ñ—à—É—î, —á–∏ –º–æ–∂–Ω–∞ –≤–∞–º –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–∞–π–ª, —è–∫—â–æ —É –≤–∞—Å —î –∫—ñ–ª—å–∫–∞ —Å—É–ø–µ—Ä–µ—á–ª–∏–≤–∏—Ö –¥–æ–∑–≤–æ–ª—ñ–≤? –°–ø—Ä–æ–±—É–π—Ç–µ —Ü–µ–π —Å–∏–º—É–ª—è—Ç–æ—Ä, —â–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏ "–∑–æ–ª–æ—Ç–µ –ø—Ä–∞–≤–∏–ª–æ": <strong>–Ø–≤–Ω–∞ –ó–ê–ë–û–†–û–ù–ê (Deny) –∑–∞–≤–∂–¥–∏ –ø–µ—Ä–µ–º–∞–≥–∞—î –±—É–¥—å-—è–∫–∏–π –î–û–ó–í–Ü–õ (Allow)</strong>.
                </p>

                <div class="max-w-md mx-auto">
                    <div class="mb-4">
                        <label class="font-medium">–ß–ª–µ–Ω—Å—Ç–≤–æ —É –≥—Ä—É–ø–∞—Ö –¥–ª—è "Petro":</label>
                        <div class="flex items-center mt-2">
                            <input type="checkbox" id="groupUsers" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500" checked>
                            <label for="groupUsers" class="ml-2 block text-sm text-neutral-900">–ì—Ä—É–ø–∞ "Users" (–î–∞—î –¥–æ–∑–≤—ñ–ª <strong>Read</strong>)</label>
                        </div>
                        <div class="flex items-center mt-2">
                            <input type="checkbox" id="groupAdmins" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                            <label for="groupAdmins" class="ml-2 block text-sm text-neutral-900">–ì—Ä—É–ø–∞ "Admins" (–î–∞—î –¥–æ–∑–≤—ñ–ª <strong>Full Control</strong>)</label>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label for="directPermission" class="block text-sm font-medium text-neutral-900">–ü—Ä—è–º–∏–π –¥–æ–∑–≤—ñ–ª –¥–ª—è "Petro" –Ω–∞ —Ñ–∞–π–ª—ñ:</label>
                        <select id="directPermission" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md">
                            <option value="none">(–ù–µ–º–∞—î)</option>
                            <option value="deny_modify">–ó–ê–ë–û–†–û–ù–ò–¢–ò (Deny) Modify</option>
                            <option value="allow_modify">–î–û–ó–í–û–õ–ò–¢–ò (Allow) Modify</option>
                        </select>
                    </div>

                    <button id="calculateRights" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300">–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ –ü—Ä–∞–≤–∞</button>

                    <div id="result" class="mt-6 p-4 rounded-lg bg-neutral-100 hidden">
                        <h4 class="font-bold text-lg mb-2">–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ –ü—Ä–∞–≤–∞ –¥–ª—è "Petro":</h4>
                        <p id="resultText" class="text-lg"></p>
                        <p id="resultReason" class="text-sm text-neutral-600 mt-2"></p>
                    </div>
                </div>
            </div>
        </section>

        <section id="tutor" class="mt-16 pt-8 border-t border-neutral-300 scroll-mt-24">
            <h2 class="text-3xl font-bold text-neutral-900 mb-4">‚ú® –¢–≤—ñ–π –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π –ù–∞—Å—Ç–∞–≤–Ω–∏–∫ (Gemini Tutor)</h2>
            <p class="text-lg text-neutral-700 mb-6">–ó–∞–ø–∏—Ç–∞–π —É –®—Ç—É—á–Ω–æ–≥–æ –Ü–Ω—Ç–µ–ª–µ–∫—Ç—É –ø—Ä–æ –±—É–¥—å-—è–∫–∏–π —Å–∫–ª–∞–¥–Ω–∏–π —Ç–µ—Ä–º—ñ–Ω, —Ä–µ–∞–ª—å–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∞–±–æ —Å–∏—Ç—É–∞—Ü—ñ—é, –ø–æ–≤'—è–∑–∞–Ω—É –∑ –ø—Ä–∞–≤–∞–º–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ Windows. –ù–∞—Å—Ç–∞–≤–Ω–∏–∫ –Ω–∞–¥–∞—Å—Ç—å —Ç–æ–±—ñ —á—ñ—Ç–∫—É, “ë—Ä—É–Ω—Ç–æ–≤–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∞–∫—Ç—É–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ –Ü–Ω—Ç–µ—Ä–Ω–µ—Ç—É.</p>

            <div class="bg-white p-6 rounded-lg shadow-lg border border-neutral-200">
                <div class="flex flex-col md:flex-row gap-4 mb-4">
                    <input type="text" id="aiQuery" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: '–©–æ —Ç–∞–∫–µ –æ–±–ª—ñ–∫–æ–≤–∏–π –∑–∞–ø–∏—Å DefaultAccount?'" class="flex-grow p-3 border border-neutral-300 rounded-lg focus:ring-blue-500 focus:border-blue-500">
                    <button id="askAiButton" class="flex-shrink-0 bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition duration-300 flex items-center justify-center">
                        –ó–∞–ø–∏—Ç–∞—Ç–∏ –ù–∞—Å—Ç–∞–≤–Ω–∏–∫–∞
                    </button>
                </div>
                
                <div id="aiLoading" class="hidden text-center p-4">
                    <div class="spinner mx-auto"></div>
                    <p class="text-neutral-500 mt-2">–®–Ü —à—É–∫–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å...</p>
                </div>
                
                <div id="aiResponse" class="mt-4 p-4 rounded-lg bg-neutral-100 hidden">
                    <h4 class="font-bold text-lg mb-2 text-indigo-800">–í—ñ–¥–ø–æ–≤—ñ–¥—å –®–Ü:</h4>
                    <p id="responseText" class="text-neutral-800 whitespace-pre-wrap"></p>
                    <div id="sourceContainer" class="mt-3 pt-3 border-t border-neutral-300 text-sm text-neutral-600">
                        <p class="font-medium">–î–∂–µ—Ä–µ–ª–∞:</p>
                        <ul id="sourceList" class="list-disc list-inside ml-4"></ul>
                    </div>
                </div>
                <div id="aiError" class="mt-4 p-4 rounded-lg bg-red-100 text-red-700 hidden">
                    –°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.
                </div>
            </div>
        </section>

    </main>
    
    <footer class="text-center py-8 mt-16 border-t border-neutral-200">
        <p class="text-neutral-500">–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –∫–æ–Ω—Å–ø–µ–∫—Ç –Ω–∞ –æ—Å–Ω–æ–≤—ñ –º–∞—Ç–µ—Ä—ñ–∞–ª—ñ–≤ –¥–ª—è 10-–≥–æ –∫–ª–∞—Å—É.</p>
    </footer>

    <script>
        const apiKey = ""; 

        // --- TTS Helper Functions (PCM to WAV) ---

        function base64ToArrayBuffer(base64) {
            const binaryString = atob(base64);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            return bytes.buffer;
        }

        function pcmToWav(pcm16, sampleRate) {
            const numChannels = 1;
            const sampleBits = 16;
            const byteRate = numChannels * sampleRate * (sampleBits / 8);
            const blockAlign = numChannels * (sampleBits / 8);
            const dataSize = pcm16.length * (sampleBits / 8);

            const buffer = new ArrayBuffer(44 + dataSize);
            const view = new DataView(buffer);
            let offset = 0;

            function writeString(str) {
                for (let i = 0; i < str.length; i++) {
                    view.setUint8(offset++, str.charCodeAt(i));
                }
            }

            // RIFF chunk
            writeString('RIFF');
            view.setUint32(offset, 36 + dataSize, true); offset += 4;
            writeString('WAVE');

            // FMT chunk
            writeString('fmt ');
            view.setUint32(offset, 16, true); offset += 4;      // Chunk size
            view.setUint16(offset, 1, true); offset += 2;       // Audio format (1 for PCM)
            view.setUint16(offset, numChannels, true); offset += 2;
            view.setUint32(offset, sampleRate, true); offset += 4;
            view.setUint32(offset, byteRate, true); offset += 4;
            view.setUint16(offset, blockAlign, true); offset += 2;
            view.setUint16(offset, sampleBits, true); offset += 2;

            // Data chunk
            writeString('data');
            view.setUint32(offset, dataSize, true); offset += 4;

            // Write PCM data (Int16)
            for (let i = 0; i < pcm16.length; i++, offset += 2) {
                view.setInt16(offset, pcm16[i], true);
            }

            return new Blob([buffer], { type: 'audio/wav' });
        }
        
        // --- Gemini API Call Function with Backoff ---

        async function fetchApiWithBackoff(url, payload, maxRetries = 5) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.status === 429 && i < maxRetries - 1) {
                        const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        continue;
                    }
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return await response.json();
                } catch (error) {
                    if (i === maxRetries - 1) throw error;
                    const delay = Math.pow(2, i) * 1000 + Math.random() * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
        }
        
        // --- Core App Logic ---

        document.addEventListener('DOMContentLoaded', () => {
            
            // --- Chart.js Initialization ---
            const ctx = document.getElementById('groupPowerChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ (Administrators)', '–û–ø–µ—Ä–∞—Ç–æ—Ä–∏ –ù–∞—Å—Ç—Ä. –ú–µ—Ä–µ–∂—ñ (Network Ops)', '–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ (Users)', '–ì–æ—Å—Ç—ñ (Guests)'],
                    datasets: [{
                        label: '–†—ñ–≤–µ–Ω—å –ü–æ–≤–Ω–æ–≤–∞–∂–µ–Ω—å',
                        data: [100, 60, 20, 5],
                        backgroundColor: [
                            'rgba(220, 38, 38, 0.6)',
                            'rgba(234, 179, 8, 0.6)',
                            'rgba(37, 99, 235, 0.6)',
                            'rgba(107, 114, 128, 0.6)'
                        ],
                        borderColor: [
                            'rgba(220, 38, 38, 1)',
                            'rgba(234, 179, 8, 1)',
                            'rgba(37, 99, 235, 1)',
                            'rgba(107, 114, 128, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.x !== null) {
                                        label += context.parsed.x + '%';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%'
                                }
                            }
                        }
                    }
                }
            });

            // --- Effective Rights Simulator Logic ---
            const calculateBtn = document.getElementById('calculateRights');
            const resultDiv = document.getElementById('result');
            const resultText = document.getElementById('resultText');
            const resultReason = document.getElementById('resultReason');
            
            calculateBtn.addEventListener('click', () => {
                const isUser = document.getElementById('groupUsers').checked;
                const isAdmin = document.getElementById('groupAdmins').checked;
                const directPermission = document.getElementById('directPermission').value;

                let allow = new Set();
                let deny = new Set();
                let reason = '';

                if (isUser) {
                    allow.add('Read');
                }
                if (isAdmin) {
                    allow.add('Read');
                    allow.add('Modify');
                    allow.add('Full Control');
                }

                if (directPermission === 'allow_modify') {
                    allow.add('Modify');
                } else if (directPermission === 'deny_modify') {
                    deny.add('Modify');
                }
                
                let canRead = allow.has('Read') || allow.has('Full Control');
                let canModify = allow.has('Modify') || allow.has('Full Control');

                if (deny.has('Modify')) {
                    canModify = false;
                    reason = '–î–æ–∑–≤—ñ–ª "Modify" –±—É–≤ —è–≤–Ω–æ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏–π (Deny). –ó–∞–±–æ—Ä–æ–Ω–∞ –∑–∞–≤–∂–¥–∏ –º–∞—î –≤–∏—â–∏–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≥—Ä—É–ø–∞ "Admins" –Ω–∞–¥–∞—î "Full Control".';
                } else if (isAdmin) {
                    reason = 'Petro –º–∞—î "Full Control" –≤—ñ–¥ –≥—Ä—É–ø–∏ "Admins", —â–æ –≤–∫–ª—é—á–∞—î "Read" —Ç–∞ "Modify".';
                } else if (directPermission === 'allow_modify') {
                    reason = 'Petro –æ—Ç—Ä–∏–º–∞–≤ "Read" –≤—ñ–¥ –≥—Ä—É–ø–∏ "Users" —Ç–∞ "Modify" –Ω–∞–ø—Ä—è–º—É.';
                } else if (directPermission === 'none' && !isAdmin && isUser) {
                     reason = 'Petro –º–∞—î –ø—Ä–∞–≤–æ "Read" –≤—ñ–¥ –≥—Ä—É–ø–∏ "Users", –∞–ª–µ –Ω–µ –º–∞—î –ø—Ä–∞–≤–∞ "Modify", –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–æ –Ω–µ –±—É–ª–æ –Ω–∞–¥–∞–Ω–æ.';
                } else {
                     reason = '–î–æ–∑–≤—ñ–ª –Ω–∞–¥–∞—î—Ç—å—Å—è —à–ª—è—Ö–æ–º —Å—É–º—É–≤–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª—ñ–≤ —É—Å—ñ—Ö –≥—Ä—É–ø, –¥–æ —è–∫–∏—Ö –Ω–∞–ª–µ–∂–∏—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á, —è–∫—â–æ –Ω–µ–º–∞—î —è–≤–Ω–∏—Ö –∑–∞–±–æ—Ä–æ–Ω.';
                }


                const readResult = canRead ? '<span class="text-green-600 font-bold">–î–û–ó–í–û–õ–ï–ù–û</span>' : '<span class="text-red-600 font-bold">–ó–ê–ë–û–†–û–ù–ï–ù–û</span>';
                const modifyResult = canModify ? '<span class="text-green-600 font-bold">–î–û–ó–í–û–õ–ï–ù–û</span>' : '<span class="text-red-600 font-bold">–ó–ê–ë–û–†–û–ù–ï–ù–û</span>';

                resultText.innerHTML = `<strong>–ß–∏—Ç–∞–Ω–Ω—è (Read):</strong> ${readResult} <br> <strong>–ó–º—ñ–Ω–∞ (Modify):</strong> ${modifyResult}`;
                resultReason.textContent = reason;
                resultDiv.classList.remove('hidden');
            });

            // --- Navigation Logic ---
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('section');

            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.3
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        navLinks.forEach(link => {
                            link.classList.remove('active');
                            if (link.getAttribute('href') === `#${entry.target.id}`) {
                                link.classList.add('active');
                            }
                        });
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                observer.observe(section);
            });
            
            // --- TTS API Integration (gemini-2.5-flash-preview-tts) ---
            const ttsButton = document.getElementById('ttsButton');
            const ttsIcon = document.getElementById('ttsIcon');
            const ttsLoading = document.getElementById('ttsLoading');
            const ttsAudio = document.getElementById('ttsAudio');
            const ttsText = "–ü—Ä–∏–Ω—Ü–∏–ø –ù–∞–π–º–µ–Ω—à–∏—Ö –ü—Ä–∏–≤—ñ–ª–µ—ó–≤: –ö–æ–∂–µ–Ω –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ –ª–∏—à–µ —Ç—ñ –ø—Ä–∞–≤–∞, —è–∫—ñ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –π–æ–º—É –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–≤–æ—ó—Ö —Ä–æ–±–æ—á–∏—Ö –∑–∞–≤–¥–∞–Ω—å, —ñ –Ω–µ –±—ñ–ª—å—à–µ. –¶–µ –∑–æ–ª–æ—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏.";

            ttsButton.addEventListener('click', async () => {
                if (ttsAudio.src) {
                    ttsAudio.play();
                    return;
                }

                ttsIcon.classList.add('hidden');
                ttsLoading.classList.remove('hidden');
                ttsButton.disabled = true;

                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${apiKey}`;
                const payload = {
                    contents: [{
                        parts: [{ text: ttsText }]
                    }],
                    generationConfig: {
                        responseModalities: ["AUDIO"],
                        speechConfig: {
                            voiceConfig: {
                                prebuiltVoiceConfig: { voiceName: "Kore" }
                            }
                        }
                    },
                    model: "gemini-2.5-flash-preview-tts"
                };

                try {
                    const result = await fetchApiWithBackoff(apiUrl, payload);

                    const part = result?.candidates?.[0]?.content?.parts?.[0];
                    const audioData = part?.inlineData?.data;
                    const mimeType = part?.inlineData?.mimeType;

                    if (audioData && mimeType && mimeType.startsWith("audio/")) {
                        const sampleRateMatch = mimeType.match(/rate=(\d+)/);
                        const sampleRate = sampleRateMatch ? parseInt(sampleRateMatch[1], 10) : 16000;
                        
                        const pcmData = base64ToArrayBuffer(audioData);
                        const pcm16 = new Int16Array(pcmData);
                        const wavBlob = pcmToWav(pcm16, sampleRate);
                        
                        ttsAudio.src = URL.createObjectURL(wavBlob);
                        ttsAudio.play();
                    } else {
                        console.error("TTS audio data missing or invalid format.");
                    }
                } catch (error) {
                    console.error("TTS API error:", error);
                } finally {
                    ttsIcon.classList.remove('hidden');
                    ttsLoading.classList.add('hidden');
                    ttsButton.disabled = false;
                }
            });

            // --- AI Tutor Integration (gemini-2.5-flash-preview-09-2025 with Grounding) ---
            const askAiButton = document.getElementById('askAiButton');
            const aiQueryInput = document.getElementById('aiQuery');
            const aiLoadingDiv = document.getElementById('aiLoading');
            const aiResponseDiv = document.getElementById('aiResponse');
            const responseText = document.getElementById('responseText');
            const sourceList = document.getElementById('sourceList');
            const aiErrorDiv = document.getElementById('aiError');

            askAiButton.addEventListener('click', async () => {
                const userQuery = aiQueryInput.value.trim();
                if (!userQuery) return;

                aiResponseDiv.classList.add('hidden');
                aiErrorDiv.classList.add('hidden');
                aiLoadingDiv.classList.remove('hidden');
                askAiButton.disabled = true;

                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

                const systemPrompt = "–í–∏ ‚Äî –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏–π –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫ –∑ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏ Windows –¥–ª—è —É—á–Ω—ñ–≤ 10-—Ö –∫–ª–∞—Å—ñ–≤. –ü–æ—è—Å–Ω—ñ—Ç—å –∑–∞–ø–∏—Ç –ø—Ä–æ—Å—Ç–æ—é, –∞–ª–µ —Ç–æ—á–Ω–æ—é —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é. –ë—É–¥—å—Ç–µ —Å—Ç–∏—Å–ª–∏–º–∏, –∞–ª–µ –≤–∏—á–µ—Ä–ø–Ω–∏–º–∏. –û–±–æ–≤'—è–∑–∫–æ–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Google Search –¥–ª—è –Ω–∞–¥–∞–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—ó —Ç–∞ “ë—Ä—É–Ω—Ç–æ–≤–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó.";
                
                const payload = {
                    contents: [{ parts: [{ text: userQuery }] }],
                    tools: [{ "google_search": {} }],
                    systemInstruction: {
                        parts: [{ text: systemPrompt }]
                    }
                };

                try {
                    const result = await fetchApiWithBackoff(apiUrl, payload);
                    const candidate = result.candidates?.[0];

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        responseText.textContent = candidate.content.parts[0].text;
                        
                        sourceList.innerHTML = '';
                        const groundingMetadata = candidate.groundingMetadata;
                        let sourcesFound = false;

                        if (groundingMetadata && groundingMetadata.groundingAttributions) {
                            groundingMetadata.groundingAttributions.forEach(attribution => {
                                if (attribution.web?.uri && attribution.web?.title) {
                                    const listItem = document.createElement('li');
                                    listItem.innerHTML = `<a href="${attribution.web.uri}" target="_blank" class="source-link" rel="noopener noreferrer">${attribution.web.title}</a>`;
                                    sourceList.appendChild(listItem);
                                    sourcesFound = true;
                                }
                            });
                        }
                        
                        if (!sourcesFound) {
                            sourceList.innerHTML = '<li>–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–Ω–∞–π—Ç–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –¥–∂–µ—Ä–µ–ª.</li>';
                        }

                        aiResponseDiv.classList.remove('hidden');
                    } else {
                        aiErrorDiv.classList.remove('hidden');
                    }
                } catch (error) {
                    console.error("AI Tutor API error:", error);
                    aiErrorDiv.classList.remove('hidden');
                } finally {
                    aiLoadingDiv.classList.add('hidden');
                    askAiButton.disabled = false;
                }
            });
        });
    </script>
</body>
</html>